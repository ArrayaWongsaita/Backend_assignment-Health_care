# üìå ER Diagram: Health Tracker API

## üìã **Entities & Relationships**

‡∏£‡∏∞‡∏ö‡∏ö‡∏ô‡∏µ‡πâ‡∏°‡∏µ **3 Entity ‡∏´‡∏•‡∏±‡∏Å** ‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ:

1. **User** - ‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ (‡∏ó‡∏±‡πâ‡∏á‡πÅ‡∏û‡∏ó‡∏¢‡πå‡πÅ‡∏•‡∏∞‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢)
2. **DoctorNote** - ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏Ç‡∏≠‡∏á‡πÅ‡∏û‡∏ó‡∏¢‡πå‡πÉ‡∏´‡πâ‡∏Å‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢
3. **HealthRecord** - ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢

---

## üî• **Entity Details**

### **User**

| Column      | Type       | Description                 |
| ----------- | ---------- | --------------------------- |
| `id`        | `Int (PK)` | ‡∏£‡∏´‡∏±‡∏™‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ                  |
| `username`  | `String`   | ‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ (Unique)         |
| `password`  | `String`   | ‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô (hashed)           |
| `role`      | `Role`     | ‡∏ö‡∏ó‡∏ö‡∏≤‡∏ó (DOCTOR ‡∏´‡∏£‡∏∑‡∏≠ PATIENT) |
| `createdAt` | `DateTime` | ‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ö‡∏±‡∏ç‡∏ä‡∏µ           |
| `updatedAt` | `DateTime` | ‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î         |

### **DoctorNote**

| Column      | Type       | Description          |
| ----------- | ---------- | -------------------- |
| `id`        | `Int (PK)` | ‡∏£‡∏´‡∏±‡∏™‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥    |
| `doctorId`  | `Int (FK)` | ‡πÅ‡∏û‡∏ó‡∏¢‡πå‡∏ó‡∏µ‡πà‡πÉ‡∏´‡πâ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥   |
| `patientId` | `Int (FK)` | ‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ |
| `note`      | `String`   | ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏à‡∏≤‡∏Å‡πÅ‡∏û‡∏ó‡∏¢‡πå      |
| `createdAt` | `DateTime` | ‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å   |
| `updatedAt` | `DateTime` | ‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î  |

### **HealthRecord**

| Column      | Type       | Description                  |
| ----------- | ---------- | ---------------------------- |
| `id`        | `Int (PK)` | ‡∏£‡∏´‡∏±‡∏™‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û             |
| `patientId` | `Int (FK)` | ‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å (‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢)      |
| `type`      | `String`   | ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û           |
| `value`     | `String?`  | ‡∏Ñ‡πà‡∏≤‡∏Ç‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (optional)      |
| `unit`      | `String?`  | ‡∏´‡∏ô‡πà‡∏ß‡∏¢ (optional)             |
| `note`      | `String?`  | ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏° (optional) |
| `createdAt` | `DateTime` | ‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å           |
| `updatedAt` | `DateTime` | ‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î          |

---

## üìå **Relationships**

- **User (DOCTOR) (1) ‚Üí (M) DoctorNote** - ‡πÅ‡∏û‡∏ó‡∏¢‡πå‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÉ‡∏´‡πâ‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡πÑ‡∏î‡πâ‡∏´‡∏•‡∏≤‡∏¢‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£
- **User (PATIENT) (1) ‚Üí (M) DoctorNote** - ‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏£‡∏±‡∏ö‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏à‡∏≤‡∏Å‡πÅ‡∏û‡∏ó‡∏¢‡πå‡πÑ‡∏î‡πâ‡∏´‡∏•‡∏≤‡∏¢‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£
- **User (PATIENT) (1) ‚Üí (M) HealthRecord** - ‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏°‡∏µ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡πÑ‡∏î‡πâ‡∏´‡∏•‡∏≤‡∏¢‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£

---

## üñº **ER Diagram**

```mermaid
erDiagram
    User ||--o{ DoctorNote : "writes (as Doctor)"
    User ||--o{ DoctorNote : "receives (as Patient)"
    User ||--o{ HealthRecord : "has"

    User {
        int id PK
        string username UK
        string password
        Role role
        datetime createdAt
        datetime updatedAt
    }
    DoctorNote {
        int id PK
        int doctorId FK
        int patientId FK
        string note
        datetime createdAt
        datetime updatedAt
    }
    HealthRecord {
        int id PK
        int patientId FK
        string type
        string value
        string unit
        string note
        datetime createdAt
        datetime updatedAt
    }
```

````

## üìñ **‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á: Self-Referential Relation (2 Relations ‡πÉ‡∏ô 1 Model)**

### **‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå:**
User ‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏°‡∏µ **2 ‡∏ö‡∏ó‡∏ö‡∏≤‡∏ó** ‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö:
- **‡πÅ‡∏û‡∏ó‡∏¢‡πå** (Doctor) ‚Üí ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÉ‡∏´‡πâ‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢
- **‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢** (Patient) ‚Üí ‡∏£‡∏±‡∏ö‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏à‡∏≤‡∏Å‡πÅ‡∏û‡∏ó‡∏¢‡πå

‡∏î‡∏±‡∏á‡∏ô‡∏±‡πâ‡∏ô User ‡∏ï‡πâ‡∏≠‡∏á relate ‡∏Å‡∏±‡∏ö DoctorNote **2 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á** ‡πÉ‡∏ô‡∏ö‡∏ó‡∏ö‡∏≤‡∏ó‡∏ó‡∏µ‡πà‡∏ï‡πà‡∏≤‡∏á‡∏Å‡∏±‡∏ô

---

### **‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á Code:**

```prisma
model User {
  // ... fields ‡∏≠‡∏∑‡πà‡∏ô‡πÜ ...

  // Relation 1: ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ó‡∏µ‡πà User ‡∏ô‡∏µ‡πâ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÉ‡∏ô‡∏ê‡∏≤‡∏ô‡∏∞‡πÅ‡∏û‡∏ó‡∏¢‡πå
  doctorNotes  DoctorNote[] @relation("DoctorNotesAsDoctor")

  // Relation 2: ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ó‡∏µ‡πà User ‡∏ô‡∏µ‡πâ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡πÉ‡∏ô‡∏ê‡∏≤‡∏ô‡∏∞‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢
  patientNotes DoctorNote[] @relation("DoctorNotesAsPatient")
}

model DoctorNote {
  // ... fields ‡∏≠‡∏∑‡πà‡∏ô‡πÜ ...

  doctorId  Int
  patientId Int

  // Relation 1: ‡∏ä‡∏µ‡πâ‡πÑ‡∏õ‡∏´‡∏≤ User ‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏û‡∏ó‡∏¢‡πå
  doctor  User @relation("DoctorNotesAsDoctor", fields: [doctorId], references: [id])

  // Relation 2: ‡∏ä‡∏µ‡πâ‡πÑ‡∏õ‡∏´‡∏≤ User ‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢
  patient User @relation("DoctorNotesAsPatient", fields: [patientId], references: [id])
}
````

---

### **‡∏™‡∏¥‡πà‡∏á‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç:**

1. **Named Relations ‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô** - ‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ `@relation("‡∏ä‡∏∑‡πà‡∏≠")` ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏¢‡∏Å‡πÅ‡∏¢‡∏∞ relation ‡∏ó‡∏±‡πâ‡∏á 2 ‡πÅ‡∏ö‡∏ö
   - `"DoctorNotesAsDoctor"` = User ‡πÉ‡∏ô‡∏ê‡∏≤‡∏ô‡∏∞‡πÅ‡∏û‡∏ó‡∏¢‡πå
   - `"DoctorNotesAsPatient"` = User ‡πÉ‡∏ô‡∏ê‡∏≤‡∏ô‡∏∞‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢

2. **‡∏ä‡∏∑‡πà‡∏≠‡πÉ‡∏ô `@relation()` ‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô** ‡∏ó‡∏±‡πâ‡∏á 2 ‡∏ù‡∏±‡πà‡∏á (User ‡πÅ‡∏•‡∏∞ DoctorNote)

3. **Foreign Keys ‡πÅ‡∏¢‡∏Å‡∏Å‡∏±‡∏ô** - `doctorId` ‡πÅ‡∏•‡∏∞ `patientId` ‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏ô‡∏•‡∏∞ field
